# Lecture 5, Tools of the Trade

#### Multi-language programming: Example

- Write the following three files

```fortran multi_prog.f90
SUBROUTINE Fsub1(n) BIND(C,NAME="FSub1")
  USE ISO_C_BINDING
  IMPLICIT NONE
  INTEGER(C_INT),INTENT(IN),VALUE :: n
  WRITE(*,*) "Hello from Fortran!"
  WRITE(*,*) "C Says", n
END SUBROUTINE
```

```c multi_prog.h
//Definition of coresponding C interface
void FSub1(int n);
```

```c C_call_fortran.c (Main function)
#include "multi_prog.h"

int main(){
  int i;
  i = 5;
  FSub1(i);
}
```


- Compile in the following order

```bash
gfortran -c multi_prog.f90   
gcc -c C_call_fortran.c   
gfortran C_call_fortran.o multi_prog.o -o C_call_fortran.exe
```

Then run

```./C_call_fortran.exe```

#### Version control

- Models for version control programs:
- Centralized Version Control (not so popular) (e.g. CVS, SVN)
- Distributed Version Control (most popular today) (e.g. git, hg)
    - interactions between *Workstation(s)* and *Repository*
    - There is one *main repository* on the server
    - Each Workstation has its own repository
    - workstation *commit* and *update* with its own repository
    - each repository *pull* and *push* with the main repository

##### git

- Note: git is *just a tool*, it's only as good as its user (see XKCD comic for bad use of git)
 ![](xkcd_git_commit.png)
 
- initialize git `git init`
- see info `git status`
- see what has been changed `git diff`
- *commit* a change

    ```bash
    git commit
    
    git config --global user.name "Brendan Kochunas"
    git config --global user.email "bkochuna@umich.edu"
    git commit --amend --reset-author
    ```
    
- git concepts: 
    - commits
    - branches
    - merge
    - fetch
    - pull (`git pull` = `git fetch` & `git merge`)
    - rebase (rewrites history, dangerous/useful alternative to merge)

#### CMake    

- configuration tool, open source, cross platform (truly)
- software projects using CMake: LAPACK, HDF5, Netflix
- The CMake builds project nicely: when `make` to run the Makefile generated by CMake, will *display helpful info* such as percentage progress etc.
- `make clean` clear things made
- `make -j8` make in parallel
- `make help` see available option of the Makefile

```
## random codes copied from lecture
which gitk
mkdir CMakeExample
cd CMakeExample/
cp -r ../gitExample .


CMAKE_MINIMUM_REQUIRED(VERSION 2.8.11)

PROJECT(Lecture5_Example)

ENABLE_LANGUAGE(C)
ENABLE_LANGUAGE(Fortran)

ADD_SUBROUTINE(
```

#### Prepare for Lab 3

- Suggested exercise: [http://learngitbranching.js.org/](http://learngitbranching.js.org/)
